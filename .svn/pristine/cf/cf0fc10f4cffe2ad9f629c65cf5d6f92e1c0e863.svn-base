package com.ghost.controller;

import java.util.List;

import javax.servlet.http.HttpServletRequest;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

import com.ghost.domain.Email;
import com.ghost.domain.Employee;
import com.ghost.service.EmailService;

@Controller
@RequestMapping("/Email")
public class EmailController {
	@Autowired
	private EmailService emailService;
	
	//查询所有邮箱申请列表
	@RequestMapping("/findAllEmail")
	public ModelAndView findAllEmail() throws Exception{
		System.out.println("===========findAllEmail============");
		//邮箱申请列表
		List<Email> emailList=emailService.findAllEmail();
		
		//创建modelAndView准备填充数据、设置视图
		ModelAndView modelAndView=new ModelAndView();
		
		//填充数据
		modelAndView.addObject("emailList", emailList);
		//视图
		modelAndView.setViewName("emailList.jsp");
		
		
		return modelAndView;
	}
	
	
	//根据员工id来查询特定的邮箱申请表数据
	@RequestMapping("/findEmailByEmpId")
	public ModelAndView findEmailByEmpId(HttpServletRequest request)throws Exception{
		System.out.println("===========findEmailByEmpId============");
		Employee employee = (Employee) request.getAttribute("employee");
		int emp_id = employee.getEmp_Id();
		List<Email> emailList = emailService.findEmailByEmpId(emp_id);
		ModelAndView modelAndView = new ModelAndView();
		modelAndView.addObject("emailList",emailList);
		modelAndView.setViewName("emailList.jsp");
		return modelAndView;
	}
	
	
	//根据邮箱申请表的id来查询特定的邮箱申请表的数据
	@RequestMapping("/findEmailById")
	public ModelAndView findEmailById(HttpServletRequest request) throws Exception{
		System.out.println("===========findEmailById============");
		//接收邮箱申请表的id
		int email_id=Integer.parseInt(request.getParameter("email_id"));
		
		System.out.println(email_id+"================");
		//根据邮箱的id来查询的有关数据
		Email email=emailService.findEmailById(email_id);
		
		
		//创建modelAndView准备填充数据、设置视图
		ModelAndView modelAndView=new ModelAndView();
		
		//填充数据
		modelAndView.addObject("email", email);
		//视图
		modelAndView.setViewName("editEmail.jsp");
		
		return modelAndView;
		
	}
	
	
	//增加邮箱申请表的数据
	@RequestMapping("/addEmail")
	public String addEmail(Email email) throws Exception{
		System.out.println("===========addEmail============");
		
		emailService.addEmail(email);
		
		return "findAllEmail.action";
		
	}
	
	
	//修改邮箱申请表的数据
	@RequestMapping("/updateEmail")
	public String updateEmail(Email email) throws Exception{
		System.out.println("===========updateEmail============");
		
		emailService.updateEmail(email);
		
		return "findAllEmail.action";
		
	}
	
	
	//删除邮箱申请表的数据
	@RequestMapping("/deleteEmail")
	public String deleteEmail(/*Integer[] emails_id*/int email_id) throws Exception{
		System.out.println("===========deleteEmail============");
		
		emailService.deleteEmail(email_id);
		/*for(int i=0;i<emails_id.length;i++){
			emailService.deleteEmail(emails_id[i]);
		}*/
		
		return "findAllEmail.action";
		
	}
	
	
	
	
	
	
	
	
	
	
	
}
